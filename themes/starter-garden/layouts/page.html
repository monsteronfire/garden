{{ define "main" }}
  <div class="wrapper">
    <div class="storymeta">
      {{ partial "components/breadcrumbs.html" . }}
      <h1>{{ .Title }}</h1>

      <div class="storymeta__item">
        {{ if and .Params.date_planted .Params.date_tended }}
          {{ partial "details.html" . }}
        {{ end }}

        {{ if or .Params.vibes .Params.effort .Params.completeness .Params.certainty }}
          {{ partial "epistemic.html" . }}
        {{ end }}
      </div>

      {{ partial "tags.html" . }}
    </div>

    <section class="story fade-in-up">
      <aside class="sidebar">
        {{ partial "components/tableofcontents" . }}
      </aside>

      <article class="mainarticlecontent">
        {{ partial "wikilinks.html" .Content }}

        {{ partial "backlinks.html" . }}

      </article>
    </section>
    
  </div>

  {{/*  tableofcontents file  */}}
  {{- $tableofcontents := resources.Get "js/tableofcontents.js" }}
    {{- if $tableofcontents }}
      {{- if hugo.IsDevelopment }}
        <script src="{{ $tableofcontents.RelPermalink }}"></script>
    {{- else }}
      {{- with $tableofcontents | minify | fingerprint }}
        <script src="{{ .RelPermalink }}" integrity="{{ .Data.Integrity }}" crossorigin="anonymous"></script>
      {{- end }}
    {{- end }}
  {{- end }}

    {{/*  copy-button file  */}}
  {{- $copybutton := resources.Get "js/copy-button.js" }}
    {{- if $copybutton }}
      {{- if hugo.IsDevelopment }}
        <script src="{{ $copybutton.RelPermalink }}"></script>
    {{- else }}
      {{- with $copybutton | minify | fingerprint }}
        <script src="{{ .RelPermalink }}" integrity="{{ .Data.Integrity }}" crossorigin="anonymous"></script>
      {{- end }}
    {{- end }}
  {{- end }}

{{ end }}
